---
layout:     post
title:      "第7周 性能优化(一)"
subtitle:   "作者：于磊 来自：极客大学架构师训练营"
date:       2020-11-06 00:00:00
author:     "于磊"
header-img: "img/a/index1.png"
catalog: true
tags:
    - 极客大学
    - 架构师




---





## 作业一（至少完成一项）：

1. 性能压测的时候，随着并发压力的增加，系统响应时间和吞吐量如何变化，为什么？

   性能压测的时候，随着并发压力的增加。TPS 吞吐量和系统资源会经过三个关键阶段的变化，呈特性曲线的样子。

   **前期（性能测试）：**一开始没有并发请求的时候，服务器资源都是空闲的。TPS 吞吐量为 0，当有 10 个并发，5 个并发的时候。系统可以创建出这么多线程去处理这些并发请求。每个线程都可以获得 CPU 的调度，都可以有足够的内存空间、网络资源、磁盘存储来使用。这时的 TPS 吞吐量很快就处理完了。

   **中期（负载测试）：**当过了某个临界点，服务器呈现出资源不足的情形。比如一个 48 核的 CPU, 200 个线程并发处理请求，不可能每个线程都同时在处理，那就有一些线程要等待 CPU 调度，处于等待状态，它的响应时间就会变长，响应时间变长了处理速度就慢了。

   **后期（压力测试）：**当达到最终临界点，服务器的资源消耗了极限。再增加新的请求，处理能力反而会下降。此时内存已经没有了，还有新的并发请求需要创建线程，此时就会使用磁盘的虚拟内存。CPU 会处在与磁盘进行虚拟内存置换的繁忙状态，实际的业务请求处理能力越降越低。一堆线程都等着资源，直到所有的请求都失去了响应，系统看起来像崩溃一样。此时的并发请求越多，响应时间开始逐渐的变长，吞吐量呈下降的情况。直到降到某个点系统彻底崩溃掉。

   

2. 用你熟悉的编程语言写一个 Web 性能压测工具，输入参数：URL，请求总次数，并发数。输出参数：平均响应时间，95% 响应时间。用这个测试工具以 10 并发、100 次请求压测 www.baidu.com。

## 作业二：根据当周学习情况，完成一篇学习总结

![目录](/img/a/07/目录.png)

![7.1 性能测试：系统性能的主要技术指标](/img/a/07/7.1 性能测试：系统性能的主要技术指标.png)

![7.2 全链路压测的挑战](/img/a/07/7.2 全链路压测的挑战.png)

![7.3 性能优化：系统性能优化的分层思想](/img/a/07/7.3 性能优化：系统性能优化的分层思想.png)

![7.4 操作系统：计算机如何处理成百上千的并发请求？](/img/a/07/7.4 操作系统：计算机如何处理成百上千的并发请求？.png)

![7.5 锁：锁原语 CAS 与各类锁](/img/a/07/7.5 锁：锁原语 CAS 与各类锁.png)